TOM TAT DU AN PLATE VIOLATION DETECTION SYSTEM
===============================================

Thong tin du an:
- Ten du an: Plate Violation Detection System
- Sinh vien: Le Hoang Phuc
- MSSV: 190501014
- Truong: Dai hoc Binh Duong - Phan hieu Ca Mau
- Nam: 2024-2025

NHUNG DIEU DA LAM DUOC
======================

1. HE THONG PHAT HIEN VI PHAM TOC DO
   - Phat hien xe vi pham toc do real-time
   - Tinh toan toc do chinh xac dua tren pixel movement
   - He thong chong trung lap vi pham voi cooldown 5 giay
   - Luu tru bang chung day du: anh xe, anh bien so, video vi pham 5 giay

2. NHAN DIEN BIEN SO XE TU DONG
   - Su dung FastALPR de nhan dien bien so xe
   - Do chinh xac tren 90%
   - Ho tro bien so Viet Nam
   - Co he thong cache de tang toc do xu ly
   - Co the su dung Enhanced Plate Detector voi nhieu phuong phap fallback

3. TRACKING DA DOI TUONG
   - Su dung OC-SORT hoac ByteTrack de track nhieu xe cung luc
   - Do chinh xac tren 90%
   - Tracking muot, khong bi mat track khi xe di nhanh
   - Ho tro track nhieu loai xe: o to, xe may, xe bus, xe tai

4. KIEN TRUC 7 THREAD
   - Thread 1: video_thread - Doc frame tu video va push vao queues
   - Thread 2: detection_worker - YOLO detection, OC-SORT tracking, tinh toc do
   - Thread 3: alpr_proactive_worker - Background ALPR detection de cache ket qua
   - Thread 4: alpr_realtime_worker - ALPR realtime khi co violation
   - Thread 5: best_frame_selector_worker - Chon frame tot nhat tu buffer
   - Thread 6: violation_worker - Luu database, anh, video vi pham
   - Thread 7: telegram_worker - Gui thong bao Telegram
   - Tat ca threads chay song song, khong block nhau
   - Su dung queue-based architecture de giao tiep giua threads

5. HE THONG QUEUE VA BUFFER
   - 8 queues de giao tiep giua threads
   - 4 buffers de luu tru frames va du lieu
   - Queue sizes duoc toi uu de tranh bi day
   - Buffer cleanup tu dong de tranh memory leak

6. XU LY VIDEO
   - Ho tro xu ly video offline (upload video)
   - Doc video nhanh nhat co the, khong delay theo FPS
   - Timestamp chinh xac tu frame number va FPS
   - Tao video vi pham bang FFmpeg (nhanh) hoac OpenCV (fallback)
   - Video vi pham 5 giay: 2 giay truoc + 3 giay sau violation

7. LUU TRU DU LIEU
   - Luu tru theo cau truc thu muc: YYYY/MM/DD/PLATE/
   - Ten file co format: type_YYYYMMDD_HHMMSS_trackid.ext
   - Luu vao MySQL database voi day du thong tin
   - Luu relative path trong database de de serve qua web

8. GIAO DIEN WEB
   - Dashboard real-time voi live video stream
   - Quan ly vi pham voi bo loc tim kiem
   - Quan ly chu xe (Admin only)
   - He thong dang nhap voi phan quyen Admin/Viewer
   - Responsive design, tuong thich moi thiet bi
   - Dark mode navigation voi hieu ung gradient
   - Autocomplete search cho bien so
   - Health dashboard de monitor system

9. THONG BAO TELEGRAM
   - Gui thong bao tu dong khi co vi pham
   - Gui kem anh xe, anh bien so, video vi pham
   - Cap nhat status violation trong database
   - Co retry logic neu gui that bai

10. TOI UU HIEU SUAT
    - Su dung GPU neu co (CUDA hoac MPS)
    - Co the chay tren CPU nhung cham hon
    - Detection frequency co the dieu chinh
    - Detection scale co the dieu chinh de giam tai
    - Queue sizes co the dieu chinh
    - Buffer cleanup tu dong

11. DOCKER SUPPORT
    - Dockerfile cho CPU version
    - Dockerfile cho GPU version
    - Docker Compose de chay ca MySQL va Flask app
    - Deploy len AWS EC2 duoc

12. DATABASE
    - MySQL 8.0
    - 3 tables: users, vehicle_owner, violations
    - Co index de tang toc do query
    - Ho tro UTF-8 cho tieng Viet
    - Co init.sql de khoi tao database

13. MODULES VA CLASSES
    - CombinedDetector: Vehicle detection va tracking
    - SpeedTracker: Tinh toc do chinh xac
    - PlateDetector: Nhan dien bien so xe
    - EnhancedPlateDetector: Nhan dien bien so voi nhieu phuong phap
    - OfflineVideoReader: Doc video offline nhanh
    - ViolationSaver: Luu tru bang chung vi pham

14. ERROR HANDLING
    - Try-catch o nhieu noi de tranh crash
    - Logging chi tiet de debug
    - Fallback mechanisms khi co loi
    - Graceful degradation khi thieu dependencies

15. SECURITY
    - Password hashing voi werkzeug
    - Session management
    - Phan quyen Admin/Viewer
    - SQL injection prevention voi parameterized queries

16. DOCUMENTATION
    - README chuyen nghiep voi badges va icons
    - API documentation
    - Troubleshooting guide
    - Installation guide
    - Docker deployment guide
    - AWS deployment guide

CONG NGHE SU DUNG
=================

Backend:
- Python 3.10+
- Flask 2.3.3
- MySQL 8.0
- PyTorch 2.1.0

AI/ML:
- YOLOv11n (ultralytics 8.1.0) cho vehicle detection
- OC-SORT hoac ByteTrack cho multi-object tracking
- FastALPR 0.3.0 cho license plate recognition

Frontend:
- Bootstrap 4.6.2
- Font Awesome 6.5.1
- jQuery 3.6.0
- Chart.js

Video Processing:
- OpenCV 4.8.1.78
- FFmpeg (optional, preferred)

HIEU SUAT
=========

Vehicle Detection: Tren 95% do chinh xac
License Plate Detection: Tren 90% do chinh xac
Plate Recognition: Tren 85% do chinh xac (bien so Viet Nam)
Speed Calculation: Sai so Â±5 km/h

YOLOv11n FPS: 50-100 FPS (GPU), 5-15 FPS (CPU)
OC-SORT Tracking: ~200 FPS
FastALPR: 30-50 FPS
Overall System: 10-30 FPS (phu thuoc hardware)

CAC TINH NANG DAC BIET
======================

1. Dual-stream architecture: Clean stream (khong co bbox) va detection stream (co bbox)
2. ALPR proactive worker: Detect bien so truoc khi co violation de cache ket qua
3. Best frame selector: Chon frame tot nhat tu buffer dua tren blur, size, position
4. Organized folder structure: Luu tru theo YYYY/MM/DD/PLATE/ de de quan ly
5. Video creation: FFmpeg voi OpenCV fallback
6. Anti-duplicate system: Cooldown 5 giay de tranh trung lap vi pham
7. Health dashboard: Monitor system health, thread status, queue sizes
8. OfflineVideoReader: Doc video nhanh nhat co the, khong delay theo FPS

TINH TRANG DU AN
================

Hoan thanh: 100%
- Tat ca tinh nang chinh da duoc trien khai
- He thong chay on dinh
- Code duoc toi uu
- Documentation day du
- Docker support
- GitHub repository da duoc setup

NGAY CAP NHAT CUOI: 2024-12-17

